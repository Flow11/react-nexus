"use strict";

require("6to5/polyfill");
var Promise = require("bluebird");
module.exports = function (R) {
  var _ = R._;
  var should = R.should;
  var React = R.React;

  var _vanillaReactChildren = React.Children;

  var _patchedReactChildren = _.extend({}, React.Children, {
    getChildrenList: function (component) {
      if (null === component || !component.props || !component.props.children) {
        return [];
      }
      return React.Children.map(component.props.children, function (child) {
        return child;
      });
    },

    getDescendantsList: function (component) {
      var children = React.getChildrenList(component);
      var descendants = [];
      children.forEach(function (child) {
        descendants.push(child);
        React.Children.getDescendantsList(child).forEach(function (childDescendant) {
          return descendants.push(childDescendant);
        });
      });
      return descendants;
    },

    mapDescendants: function (component, fn) {
      return React.Children.getDescendantsList(component).map(fn);
    },

    mapTree: function (component, fn) {
      var tree = React.Children.getDescendantsList(component, fn);
      tree.unshift(component);
      return tree.map(fn);
    },

    restoreChildren: function () {
      _.extend(React, { Children: _vanillaReactChildren });
      return _vanillaReactChildren;
    },

    patchChildren: function () {
      _.extend(React, { Children: _patchedReactChildren });
      return _patchedReactChildren;
    },

    transformDescendants: function (component, fn) {
      var children = React.Children.getDescendantsList(component);
      if (children.length === 0) {
        return component;
      }
      if (component.props) {
        (function () {
          var transformChild = function (child) {
            return React.Children.transformTree(child, fn);
          };
          component.props.children = React.Children.mapDescendants(component, transformChild);
        })();
      }
      return component;
    },

    transformTree: function (component, fn) {
      return React.Children.transformDescendants(fn(component), fn);
    } });

  return _patchedReactChildren.patchChildren();
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImc6L3JlYWN0LW5leHVzL3JlYWN0LXJhaWxzL3NyYy9SLlJlYWN0Q2hpbGRyZW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPLENBQUMsZUFBZSxDQUFDLENBQUM7QUFDekIsSUFBTSxPQUFPLEdBQUcsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBQ3BDLE1BQU0sQ0FBQyxPQUFPLEdBQUcsVUFBUyxDQUFDLEVBQUU7QUFDM0IsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNkLE1BQU0sTUFBTSxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUM7QUFDeEIsTUFBTSxLQUFLLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQzs7QUFFdEIsTUFBTSxxQkFBcUIsR0FBRyxLQUFLLENBQUMsUUFBUSxDQUFDOztBQUU3QyxNQUFNLHFCQUFxQixHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLEtBQUssQ0FBQyxRQUFRLEVBQUU7QUFDekQsbUJBQWUsRUFBQSxVQUFDLFNBQVMsRUFBRTtBQUN6QixVQUFHLElBQUksS0FBSyxTQUFTLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxRQUFRLEVBQUU7QUFDdEUsZUFBTyxFQUFFLENBQUM7T0FDWDtBQUNELGFBQU8sS0FBSyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxRQUFRLEVBQUUsVUFBQyxLQUFLO2VBQUssS0FBSztPQUFBLENBQUMsQ0FBQztLQUN2RTs7QUFFRCxzQkFBa0IsRUFBQSxVQUFDLFNBQVMsRUFBRTtBQUM1QixVQUFJLFFBQVEsR0FBRyxLQUFLLENBQUMsZUFBZSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ2hELFVBQUksV0FBVyxHQUFHLEVBQUUsQ0FBQztBQUNyQixjQUFRLENBQUMsT0FBTyxDQUFDLFVBQUMsS0FBSyxFQUFLO0FBQzFCLG1CQUFXLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQ3hCLGFBQUssQ0FBQyxRQUFRLENBQUMsa0JBQWtCLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLFVBQUMsZUFBZTtpQkFBSyxXQUFXLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQztTQUFBLENBQUMsQ0FBQztPQUMxRyxDQUFDLENBQUM7QUFDSCxhQUFPLFdBQVcsQ0FBQztLQUNwQjs7QUFFRCxrQkFBYyxFQUFBLFVBQUMsU0FBUyxFQUFFLEVBQUUsRUFBRTtBQUM1QixhQUFPLEtBQUssQ0FBQyxRQUFRLENBQUMsa0JBQWtCLENBQUMsU0FBUyxDQUFDLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0tBQzdEOztBQUVELFdBQU8sRUFBQSxVQUFDLFNBQVMsRUFBRSxFQUFFLEVBQUU7QUFDckIsVUFBSSxJQUFJLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxrQkFBa0IsQ0FBQyxTQUFTLEVBQUUsRUFBRSxDQUFDLENBQUM7QUFDNUQsVUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUN4QixhQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUM7S0FDckI7O0FBRUQsbUJBQWUsRUFBQSxZQUFHO0FBQ2hCLE9BQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLEVBQUUsUUFBUSxFQUFFLHFCQUFxQixFQUFFLENBQUMsQ0FBQztBQUNyRCxhQUFPLHFCQUFxQixDQUFDO0tBQzlCOztBQUVELGlCQUFhLEVBQUEsWUFBRztBQUNkLE9BQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLEVBQUUsUUFBUSxFQUFFLHFCQUFxQixFQUFFLENBQUMsQ0FBQztBQUNyRCxhQUFPLHFCQUFxQixDQUFDO0tBQzlCOztBQUVELHdCQUFvQixFQUFBLFVBQUMsU0FBUyxFQUFFLEVBQUUsRUFBRTtBQUNsQyxVQUFJLFFBQVEsR0FBRyxLQUFLLENBQUMsUUFBUSxDQUFDLGtCQUFrQixDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQzVELFVBQUcsUUFBUSxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7QUFDeEIsZUFBTyxTQUFTLENBQUM7T0FDbEI7QUFDRCxVQUFHLFNBQVMsQ0FBQyxLQUFLLEVBQUU7O0FBQ2xCLGNBQUksY0FBYyxHQUFHLFVBQUMsS0FBSzttQkFBSyxLQUFLLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDO1dBQUEsQ0FBQztBQUN4RSxtQkFBUyxDQUFDLEtBQUssQ0FBQyxRQUFRLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxjQUFjLENBQUMsU0FBUyxFQUFFLGNBQWMsQ0FBQyxDQUFDOztPQUNyRjtBQUNELGFBQU8sU0FBUyxDQUFDO0tBQ2xCOztBQUVELGlCQUFhLEVBQUEsVUFBQyxTQUFTLEVBQUUsRUFBRSxFQUFFO0FBQzNCLGFBQU8sS0FBSyxDQUFDLFFBQVEsQ0FBQyxvQkFBb0IsQ0FBQyxFQUFFLENBQUMsU0FBUyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7S0FDL0QsRUFFRixDQUFDLENBQUM7O0FBRUgsU0FBTyxxQkFBcUIsQ0FBQyxhQUFhLEVBQUUsQ0FBQztDQUM5QyxDQUFDIiwiZmlsZSI6IlIuUmVhY3RDaGlsZHJlbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJzZ0bzUvcG9seWZpbGwnKTtcbmNvbnN0IFByb21pc2UgPSByZXF1aXJlKCdibHVlYmlyZCcpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihSKSB7XHJcbiAgY29uc3QgXyA9IFIuXztcclxuICBjb25zdCBzaG91bGQgPSBSLnNob3VsZDtcclxuICBjb25zdCBSZWFjdCA9IFIuUmVhY3Q7XHJcblxyXG4gIGNvbnN0IF92YW5pbGxhUmVhY3RDaGlsZHJlbiA9IFJlYWN0LkNoaWxkcmVuO1xyXG5cclxuICBjb25zdCBfcGF0Y2hlZFJlYWN0Q2hpbGRyZW4gPSBfLmV4dGVuZCh7fSwgUmVhY3QuQ2hpbGRyZW4sIHtcclxuICAgIGdldENoaWxkcmVuTGlzdChjb21wb25lbnQpIHtcclxuICAgICAgaWYobnVsbCA9PT0gY29tcG9uZW50IHx8ICFjb21wb25lbnQucHJvcHMgfHwgIWNvbXBvbmVudC5wcm9wcy5jaGlsZHJlbikge1xyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUmVhY3QuQ2hpbGRyZW4ubWFwKGNvbXBvbmVudC5wcm9wcy5jaGlsZHJlbiwgKGNoaWxkKSA9PiBjaGlsZCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGdldERlc2NlbmRhbnRzTGlzdChjb21wb25lbnQpIHtcclxuICAgICAgbGV0IGNoaWxkcmVuID0gUmVhY3QuZ2V0Q2hpbGRyZW5MaXN0KGNvbXBvbmVudCk7XHJcbiAgICAgIGxldCBkZXNjZW5kYW50cyA9IFtdO1xyXG4gICAgICBjaGlsZHJlbi5mb3JFYWNoKChjaGlsZCkgPT4ge1xyXG4gICAgICAgIGRlc2NlbmRhbnRzLnB1c2goY2hpbGQpO1xyXG4gICAgICAgIFJlYWN0LkNoaWxkcmVuLmdldERlc2NlbmRhbnRzTGlzdChjaGlsZCkuZm9yRWFjaCgoY2hpbGREZXNjZW5kYW50KSA9PiBkZXNjZW5kYW50cy5wdXNoKGNoaWxkRGVzY2VuZGFudCkpO1xyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIGRlc2NlbmRhbnRzO1xyXG4gICAgfSxcclxuXHJcbiAgICBtYXBEZXNjZW5kYW50cyhjb21wb25lbnQsIGZuKSB7XHJcbiAgICAgIHJldHVybiBSZWFjdC5DaGlsZHJlbi5nZXREZXNjZW5kYW50c0xpc3QoY29tcG9uZW50KS5tYXAoZm4pO1xyXG4gICAgfSxcclxuXHJcbiAgICBtYXBUcmVlKGNvbXBvbmVudCwgZm4pIHtcclxuICAgICAgbGV0IHRyZWUgPSBSZWFjdC5DaGlsZHJlbi5nZXREZXNjZW5kYW50c0xpc3QoY29tcG9uZW50LCBmbik7XHJcbiAgICAgIHRyZWUudW5zaGlmdChjb21wb25lbnQpO1xyXG4gICAgICByZXR1cm4gdHJlZS5tYXAoZm4pO1xyXG4gICAgfSxcclxuXHJcbiAgICByZXN0b3JlQ2hpbGRyZW4oKSB7XHJcbiAgICAgIF8uZXh0ZW5kKFJlYWN0LCB7IENoaWxkcmVuOiBfdmFuaWxsYVJlYWN0Q2hpbGRyZW4gfSk7XHJcbiAgICAgIHJldHVybiBfdmFuaWxsYVJlYWN0Q2hpbGRyZW47XHJcbiAgICB9LFxyXG5cclxuICAgIHBhdGNoQ2hpbGRyZW4oKSB7XHJcbiAgICAgIF8uZXh0ZW5kKFJlYWN0LCB7IENoaWxkcmVuOiBfcGF0Y2hlZFJlYWN0Q2hpbGRyZW4gfSk7XHJcbiAgICAgIHJldHVybiBfcGF0Y2hlZFJlYWN0Q2hpbGRyZW47XHJcbiAgICB9LFxyXG5cclxuICAgIHRyYW5zZm9ybURlc2NlbmRhbnRzKGNvbXBvbmVudCwgZm4pIHtcclxuICAgICAgbGV0IGNoaWxkcmVuID0gUmVhY3QuQ2hpbGRyZW4uZ2V0RGVzY2VuZGFudHNMaXN0KGNvbXBvbmVudCk7XHJcbiAgICAgIGlmKGNoaWxkcmVuLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiBjb21wb25lbnQ7XHJcbiAgICAgIH1cclxuICAgICAgaWYoY29tcG9uZW50LnByb3BzKSB7XHJcbiAgICAgICAgbGV0IHRyYW5zZm9ybUNoaWxkID0gKGNoaWxkKSA9PiBSZWFjdC5DaGlsZHJlbi50cmFuc2Zvcm1UcmVlKGNoaWxkLCBmbik7XHJcbiAgICAgICAgY29tcG9uZW50LnByb3BzLmNoaWxkcmVuID0gUmVhY3QuQ2hpbGRyZW4ubWFwRGVzY2VuZGFudHMoY29tcG9uZW50LCB0cmFuc2Zvcm1DaGlsZCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGNvbXBvbmVudDtcclxuICAgIH0sXHJcblxyXG4gICAgdHJhbnNmb3JtVHJlZShjb21wb25lbnQsIGZuKSB7XHJcbiAgICAgIHJldHVybiBSZWFjdC5DaGlsZHJlbi50cmFuc2Zvcm1EZXNjZW5kYW50cyhmbihjb21wb25lbnQpLCBmbik7XHJcbiAgICB9LFxyXG5cclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIF9wYXRjaGVkUmVhY3RDaGlsZHJlbi5wYXRjaENoaWxkcmVuKCk7XHJcbn07XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==