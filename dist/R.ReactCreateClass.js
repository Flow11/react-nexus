"use strict";

require("6to5/polyfill");
var Promise = require("bluebird");
module.exports = function (R) {
  var _ = R._;
  var React = R.React;

  var _vanillaCreateClass = _.scope(React.createClass, React);

  var _patchedCreateClass = function createClass(specs) {
    _.defaults(specs, {
      getFluxStoreSubscriptions: function () {
        return {};
      },
      statics: {} });

    var createdClass;

    function __ReactNexusSurrogate(_ref) {
      var context = _ref.context;
      var props = _ref.props;
      var state = _ref.state;
      var instance;
      React.withContext(context, function () {
        state = state || {};
        var element = React.createElement(createdClass, _.omit(props, "children"), props.children);
        instance = R.instantiateReactComponent(element);
        _.extend(instance, { context: context });
        if (instance.getInitialState) {
          state = _.extend({}, state, instance.getInitialState() || {});
        }
        _.extend(instance, { state: state, __ReactNexusSurrogate: __ReactNexusSurrogate });
      });
      return instance;
    }
    _.extend(specs.statics, { __ReactNexusSurrogate: __ReactNexusSurrogate });

    createdClass = _vanillaCreateClass(specs);
    return createdClass;
  };

  _.extend(_patchedCreateClass, {
    patchCreateClass: function () {
      _.extend(React, { createClass: _patchedCreateClass });
      return _patchedCreateClass;
    },

    restoreCreateClass: function () {
      _.extend(React, { createClass: _vanillaCreateClass });
      return _vanillaCreateClass;
    } });

  return _patchedCreateClass.patchCreateClass();
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImc6L3JlYWN0LW5leHVzL3JlYWN0LXJhaWxzL3NyYy9SLlJlYWN0Q3JlYXRlQ2xhc3MuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPLENBQUMsZUFBZSxDQUFDLENBQUM7QUFDekIsSUFBTSxPQUFPLEdBQUcsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBQ3BDLE1BQU0sQ0FBQyxPQUFPLEdBQUcsVUFBUyxDQUFDLEVBQUU7QUFDM0IsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNkLE1BQU0sS0FBSyxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUM7O0FBRXRCLE1BQU0sbUJBQW1CLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsV0FBVyxFQUFFLEtBQUssQ0FBQyxDQUFDOztBQUU5RCxNQUFNLG1CQUFtQixHQUFHLFNBQVMsV0FBVyxDQUFDLEtBQUssRUFBRTtBQUN0RCxLQUFDLENBQUMsUUFBUSxDQUFDLEtBQUssRUFBRTtBQUNoQiwrQkFBeUIsRUFBQSxZQUFHO0FBQUUsZUFBTyxFQUFFLENBQUM7T0FBRTtBQUMxQyxhQUFPLEVBQUUsRUFBRSxFQUNaLENBQUMsQ0FBQzs7QUFFSCxRQUFJLFlBQVksQ0FBQzs7QUFFakIsYUFBUyxxQkFBcUIsT0FBNEI7VUFBekIsT0FBTyxRQUFQLE9BQU87VUFBRSxLQUFLLFFBQUwsS0FBSztVQUFFLEtBQUssUUFBTCxLQUFLO0FBQ3BELFVBQUksUUFBUSxDQUFDO0FBQ2IsV0FBSyxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUUsWUFBTTtBQUMvQixhQUFLLEdBQUcsS0FBSyxJQUFJLEVBQUUsQ0FBQztBQUNwQixZQUFJLE9BQU8sR0FBRyxLQUFLLENBQUMsYUFBYSxDQUFDLFlBQVksRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxVQUFVLENBQUMsRUFBRSxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDM0YsZ0JBQVEsR0FBRyxDQUFDLENBQUMseUJBQXlCLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDaEQsU0FBQyxDQUFDLE1BQU0sQ0FBQyxRQUFRLEVBQUUsRUFBRSxPQUFPLEVBQVAsT0FBTyxFQUFFLENBQUMsQ0FBQztBQUNoQyxZQUFHLFFBQVEsQ0FBQyxlQUFlLEVBQUU7QUFDM0IsZUFBSyxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLEtBQUssRUFBRSxRQUFRLENBQUMsZUFBZSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7U0FDL0Q7QUFDRCxTQUFDLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxFQUFFLEtBQUssRUFBTCxLQUFLLEVBQUUscUJBQXFCLEVBQXJCLHFCQUFxQixFQUFFLENBQUMsQ0FBQztPQUN0RCxDQUFDLENBQUM7QUFDSCxhQUFPLFFBQVEsQ0FBQztLQUNqQjtBQUNELEtBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxFQUFFLHFCQUFxQixFQUFyQixxQkFBcUIsRUFBRSxDQUFDLENBQUM7O0FBRW5ELGdCQUFZLEdBQUcsbUJBQW1CLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDMUMsV0FBTyxZQUFZLENBQUM7R0FDckIsQ0FBQzs7QUFFRixHQUFDLENBQUMsTUFBTSxDQUFDLG1CQUFtQixFQUFFO0FBQzVCLG9CQUFnQixFQUFBLFlBQUc7QUFDakIsT0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsRUFBRSxXQUFXLEVBQUUsbUJBQW1CLEVBQUUsQ0FBQyxDQUFDO0FBQ3RELGFBQU8sbUJBQW1CLENBQUM7S0FDNUI7O0FBRUQsc0JBQWtCLEVBQUEsWUFBRztBQUNuQixPQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxFQUFFLFdBQVcsRUFBRSxtQkFBbUIsRUFBRSxDQUFDLENBQUM7QUFDdEQsYUFBTyxtQkFBbUIsQ0FBQztLQUM1QixFQUNGLENBQUMsQ0FBQzs7QUFFSCxTQUFPLG1CQUFtQixDQUFDLGdCQUFnQixFQUFFLENBQUM7Q0FDL0MsQ0FBQyIsImZpbGUiOiJSLlJlYWN0Q3JlYXRlQ2xhc3MuanMiLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCc2dG81L3BvbHlmaWxsJyk7XG5jb25zdCBQcm9taXNlID0gcmVxdWlyZSgnYmx1ZWJpcmQnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUikge1xuICBjb25zdCBfID0gUi5fO1xuICBjb25zdCBSZWFjdCA9IFIuUmVhY3Q7XG5cbiAgY29uc3QgX3ZhbmlsbGFDcmVhdGVDbGFzcyA9IF8uc2NvcGUoUmVhY3QuY3JlYXRlQ2xhc3MsIFJlYWN0KTtcblxuICBjb25zdCBfcGF0Y2hlZENyZWF0ZUNsYXNzID0gZnVuY3Rpb24gY3JlYXRlQ2xhc3Moc3BlY3MpIHtcbiAgICBfLmRlZmF1bHRzKHNwZWNzLCB7XG4gICAgICBnZXRGbHV4U3RvcmVTdWJzY3JpcHRpb25zKCkgeyByZXR1cm4ge307IH0sXG4gICAgICBzdGF0aWNzOiB7fSxcbiAgICB9KTtcblxuICAgIGxldCBjcmVhdGVkQ2xhc3M7XG5cbiAgICBmdW5jdGlvbiBfX1JlYWN0TmV4dXNTdXJyb2dhdGUoeyBjb250ZXh0LCBwcm9wcywgc3RhdGUgfSkge1xuICAgICAgbGV0IGluc3RhbmNlO1xuICAgICAgUmVhY3Qud2l0aENvbnRleHQoY29udGV4dCwgKCkgPT4ge1xuICAgICAgICBzdGF0ZSA9IHN0YXRlIHx8IHt9O1xuICAgICAgICBsZXQgZWxlbWVudCA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoY3JlYXRlZENsYXNzLCBfLm9taXQocHJvcHMsICdjaGlsZHJlbicpLCBwcm9wcy5jaGlsZHJlbik7XG4gICAgICAgIGluc3RhbmNlID0gUi5pbnN0YW50aWF0ZVJlYWN0Q29tcG9uZW50KGVsZW1lbnQpO1xuICAgICAgICBfLmV4dGVuZChpbnN0YW5jZSwgeyBjb250ZXh0IH0pO1xuICAgICAgICBpZihpbnN0YW5jZS5nZXRJbml0aWFsU3RhdGUpIHtcbiAgICAgICAgICBzdGF0ZSA9IF8uZXh0ZW5kKHt9LCBzdGF0ZSwgaW5zdGFuY2UuZ2V0SW5pdGlhbFN0YXRlKCkgfHwge30pO1xuICAgICAgICB9XG4gICAgICAgIF8uZXh0ZW5kKGluc3RhbmNlLCB7IHN0YXRlLCBfX1JlYWN0TmV4dXNTdXJyb2dhdGUgfSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBpbnN0YW5jZTtcbiAgICB9XG4gICAgXy5leHRlbmQoc3BlY3Muc3RhdGljcywgeyBfX1JlYWN0TmV4dXNTdXJyb2dhdGUgfSk7XG5cbiAgICBjcmVhdGVkQ2xhc3MgPSBfdmFuaWxsYUNyZWF0ZUNsYXNzKHNwZWNzKTtcbiAgICByZXR1cm4gY3JlYXRlZENsYXNzO1xuICB9O1xuXG4gIF8uZXh0ZW5kKF9wYXRjaGVkQ3JlYXRlQ2xhc3MsIHtcbiAgICBwYXRjaENyZWF0ZUNsYXNzKCkge1xuICAgICAgXy5leHRlbmQoUmVhY3QsIHsgY3JlYXRlQ2xhc3M6IF9wYXRjaGVkQ3JlYXRlQ2xhc3MgfSk7XG4gICAgICByZXR1cm4gX3BhdGNoZWRDcmVhdGVDbGFzcztcbiAgICB9LFxuXG4gICAgcmVzdG9yZUNyZWF0ZUNsYXNzKCkge1xuICAgICAgXy5leHRlbmQoUmVhY3QsIHsgY3JlYXRlQ2xhc3M6IF92YW5pbGxhQ3JlYXRlQ2xhc3MgfSk7XG4gICAgICByZXR1cm4gX3ZhbmlsbGFDcmVhdGVDbGFzcztcbiAgICB9LFxuICB9KTtcblxuICByZXR1cm4gX3BhdGNoZWRDcmVhdGVDbGFzcy5wYXRjaENyZWF0ZUNsYXNzKCk7XG59O1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9