"use strict";

require("6to5/polyfill");
var Promise = require("bluebird");
module.exports = function (R) {
  var _ = R._;
  var d3 = require("d3");
  var InterpolationTicker = require("./R.Animate.InterpolationTicker")(R);

  var Animate = {
    Mixin: {
      _AnimateMixin: true,
      _AnimateMixinInterpolationTickers: null,

      componentWillMount: function () {
        this._AnimateMixinInterpolationTickers = {};
      },

      componentWillUnmount: function () {
        var _this = this;

        Object.keys(this._AnimateMixinInterpolationTickers).forEach(function (name) {
          return _this._AnimateMixinInterpolationTickers[name].abort();
        });
        this._AnimateMixinInterpolationTickers = null;
      },

      isAnimating: function (name) {
        return this._AnimateMixinInterpolationTickers[name];
      },

      _AnimateMixinGetStateKey: function (name) {
        return "_AnimateMixinStyle-" + name;
      },

      getAnimatedStyle: function (name) {
        if (this.isAnimating(name)) {
          return this.state[this._AnimateMixinGetStateKey(name)];
        } else {
          _.dev(function () {
            return console.warn("R.Animate.Mixin.getAnimatedStyle(...): no such animation.");
          });
          return {};
        }
      },

      abortAnimation: function (name) {
        var _this2 = this;

        _.dev(function () {
          return _this2.isAnimating(name).should.be.ok;
        });
        if (this.isAnimating(name)) {
          this._AnimateMixinInterpolationTickers[name].abort();
        }
      },

      animate: function (name, params) {
        var _this3 = this;

        if (this.isAnimating(name)) {
          this.abortAnimation(name);
        }

        params = _.extend({}, params, {
          onTick: _.noop,
          onComplete: _.noop,
          onAbort: _.noop });

        var original = {
          onTick: params.onTick,
          onComplete: params.onComplete,
          onAbort: params.onAbort };

        params.onTick = function (animatedStyle, t) {
          original.onTick(animatedStyle, t);
          _this3.setStateIfMounted((function (_ref) {
            _ref[_this3._AnimateMixinGetStateKey(name)] = animatedStyle;
            return _ref;
          })({}));
        };

        params.onComplete = function (animatedStyle, t) {
          original.onComplete(animatedStyle, t);
          delete _this3._AnimateMixinInterpolationTickers[name];
          _this3.setStateIfMounted((function (_ref2) {
            _ref2[_this3._AnimateMixinGetStateKey(name)] = void 0;
            return _ref2;
          })({}));
        };

        params.onAbort = function () {
          original.onAbort();
          delete _this3._AnimateMixinInterpolationTickers[name];
          _this3.setStateIfMounted((function (_ref3) {
            _ref3[_this3._AnimateMixinGetStateKey(name)] = void 0;
            return _ref3;
          })({}));
        };

        var interpolationTicker = new R.Animate.InterpolationTicker(params);
        this._AnimateMixinInterpolationTickers[name] = interpolationTicker;
        interpolationTicker.start();
      } },

    createInterpolator: function (from, to) {
      return d3.interpolate(from, to);
    },

    createEasing: function (type, params) {
      if (params) {
        var args = _.clone(params);
        args.unshift(type);
        return d3.ease.apply(d3, args);
      } else {
        return d3.ease(type);
      }
    },

    InterpolationTicker: InterpolationTicker,

    shouldEnableHA: function () {
      if (_.isClient()) {
        var userAgent = navigator.userAgent;
        var isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);
        var isGingerbread = /Android 2\.3\.[3-7]/i.test(userAgent);
        return userAgent && isMobile && !isGingerbread;
      } else {
        return true;
      }
    } };

  return Animate;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImY6L1VzZXJzL0VsaWUvZ2l0L3JlYWN0L3JlYWN0LXJhaWxzL3NyYy9SLkFuaW1hdGUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPLENBQUMsZUFBZSxDQUFDLENBQUM7QUFDekIsSUFBTSxPQUFPLEdBQUcsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBQ3BDLE1BQU0sQ0FBQyxPQUFPLEdBQUcsVUFBUyxDQUFDLEVBQUU7QUFDM0IsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNkLE1BQU0sRUFBRSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUN6QixNQUFNLG1CQUFtQixHQUFHLE9BQU8sQ0FBQyxpQ0FBaUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDOztBQUUxRSxNQUFNLE9BQU8sR0FBRztBQUNkLFNBQUssRUFBRTtBQUNMLG1CQUFhLEVBQUUsSUFBSTtBQUNuQix1Q0FBaUMsRUFBRSxJQUFJOztBQUV2Qyx3QkFBa0IsRUFBQSxZQUFHO0FBQ25CLFlBQUksQ0FBQyxpQ0FBaUMsR0FBRyxFQUFFLENBQUM7T0FDN0M7O0FBRUQsMEJBQW9CLEVBQUEsWUFBRzs7O0FBQ3JCLGNBQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGlDQUFpQyxDQUFDLENBQ2xELE9BQU8sQ0FBQyxVQUFDLElBQUk7aUJBQUssTUFBSyxpQ0FBaUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLEVBQUU7U0FBQSxDQUFDLENBQUM7QUFDekUsWUFBSSxDQUFDLGlDQUFpQyxHQUFHLElBQUksQ0FBQztPQUMvQzs7QUFFRCxpQkFBVyxFQUFBLFVBQUMsSUFBSSxFQUFFO0FBQ2hCLGVBQU8sSUFBSSxDQUFDLGlDQUFpQyxDQUFDLElBQUksQ0FBQyxDQUFDO09BQ3JEOztBQUVELDhCQUF3QixFQUFBLFVBQUMsSUFBSSxFQUFFO0FBQzdCLGVBQU8scUJBQXFCLEdBQUcsSUFBSSxDQUFDO09BQ3JDOztBQUVELHNCQUFnQixF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QUUsRUFBRSxFQUFFO0FBQzNCLGFBQU8sRUFBRSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLENBQUM7S0FDakM7O0FBRUQsZ0JBQVksRUFBQSxVQUFDLElBQUksRUFBRSxNQUFNLEVBQUU7QUFDekIsVUFBRyxNQUFNLEVBQUU7QUFDVCxZQUFJLElBQUksR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQzNCLFlBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDbkIsZUFBTyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDLENBQUM7T0FDaEMsTUFDSTtBQUNILGVBQU8sRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztPQUN0QjtLQUNGOztBQUVELHVCQUFtQixFQUFuQixtQkFBbUI7O0FBRW5CLGtCQUFjLEVBQUEsWUFBRztBQUNmLFVBQUcsQ0FBQyxDQUFDLFFBQVEsRUFBRSxFQUFFO0FBQ2YsWUFBSSxTQUFTLEdBQUcsU0FBUyxDQUFDLFNBQVMsQ0FBQztBQUNwQyxZQUFJLFFBQVEsR0FBRyxnRUFBZ0UsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDaEcsWUFBSSxhQUFhLEdBQUcsc0JBQXNCLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQzNELGVBQU8sU0FBUyxJQUFJLFFBQVEsSUFBSSxDQUFDLGFBQWEsQ0FBQztPQUNoRCxNQUNJO0FBQ0gsZUFBTyxJQUFJLENBQUM7T0FDYjtLQUNGLEVBQ0YsQ0FBQzs7QUFFRixTQUFPLE9BQU8sQ0FBQztDQUNoQixDQUFDIiwiZmlsZSI6IlIuQW5pbWF0ZS5qcyIsInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJzZ0bzUvcG9seWZpbGwnKTtcbmNvbnN0IFByb21pc2UgPSByZXF1aXJlKCdibHVlYmlyZCcpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihSKSB7XHJcbiAgY29uc3QgXyA9IFIuXztcclxuICBjb25zdCBkMyA9IHJlcXVpcmUoJ2QzJyk7XHJcbiAgY29uc3QgSW50ZXJwb2xhdGlvblRpY2tlciA9IHJlcXVpcmUoJy4vUi5BbmltYXRlLkludGVycG9sYXRpb25UaWNrZXInKShSKTtcclxuXHJcbiAgY29uc3QgQW5pbWF0ZSA9IHtcclxuICAgIE1peGluOiB7XHJcbiAgICAgIF9BbmltYXRlTWl4aW46IHRydWUsXHJcbiAgICAgIF9BbmltYXRlTWl4aW5JbnRlcnBvbGF0aW9uVGlja2VyczogbnVsbCxcclxuXHJcbiAgICAgIGNvbXBvbmVudFdpbGxNb3VudCgpIHtcclxuICAgICAgICB0aGlzLl9BbmltYXRlTWl4aW5JbnRlcnBvbGF0aW9uVGlja2VycyA9IHt9O1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XHJcbiAgICAgICAgT2JqZWN0LmtleXModGhpcy5fQW5pbWF0ZU1peGluSW50ZXJwb2xhdGlvblRpY2tlcnMpXHJcbiAgICAgICAgLmZvckVhY2goKG5hbWUpID0+IHRoaXMuX0FuaW1hdGVNaXhpbkludGVycG9sYXRpb25UaWNrZXJzW25hbWVdLmFib3J0KCkpO1xyXG4gICAgICAgIHRoaXMuX0FuaW1hdGVNaXhpbkludGVycG9sYXRpb25UaWNrZXJzID0gbnVsbDtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGlzQW5pbWF0aW5nKG5hbWUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fQW5pbWF0ZU1peGluSW50ZXJwb2xhdGlvblRpY2tlcnNbbmFtZV07XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBfQW5pbWF0ZU1peGluR2V0U3RhdGVLZXkobmFtZSkge1xyXG4gICAgICAgIHJldHVybiAnX0FuaW1hdGVNaXhpblN0eWxlLScgKyBuYW1lO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgZ2V0QW5pbWF0ZWRTdHlsZShuYW1lKSB7XHJcbiAgICAgICAgaWYodGhpcy5pc0FuaW1hdGluZyhuYW1lKSkge1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuc3RhdGVbdGhpcy5fQW5pbWF0ZU1peGluR2V0U3RhdGVLZXkobmFtZSldO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIF8uZGV2KCgpID0+IGNvbnNvbGUud2FybignUi5BbmltYXRlLk1peGluLmdldEFuaW1hdGVkU3R5bGUoLi4uKTogbm8gc3VjaCBhbmltYXRpb24uJykpO1xyXG4gICAgICAgICAgcmV0dXJuIHt9O1xyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuXHJcbiAgICAgIGFib3J0QW5pbWF0aW9uKG5hbWUpIHtcclxuICAgICAgICBfLmRldigoKSA9PiB0aGlzLmlzQW5pbWF0aW5nKG5hbWUpLnNob3VsZC5iZS5vayk7XHJcbiAgICAgICAgaWYodGhpcy5pc0FuaW1hdGluZyhuYW1lKSkge1xyXG4gICAgICAgICAgdGhpcy5fQW5pbWF0ZU1peGluSW50ZXJwb2xhdGlvblRpY2tlcnNbbmFtZV0uYWJvcnQoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBhbmltYXRlKG5hbWUsIHBhcmFtcykge1xyXG4gICAgICAgIGlmKHRoaXMuaXNBbmltYXRpbmcobmFtZSkpIHtcclxuICAgICAgICAgIHRoaXMuYWJvcnRBbmltYXRpb24obmFtZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwYXJhbXMgPSBfLmV4dGVuZCh7fSwgcGFyYW1zLCB7XHJcbiAgICAgICAgICBvblRpY2s6IF8ubm9vcCxcclxuICAgICAgICAgIG9uQ29tcGxldGU6IF8ubm9vcCxcclxuICAgICAgICAgIG9uQWJvcnQ6IF8ubm9vcCxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IG9yaWdpbmFsID0ge1xyXG4gICAgICAgICAgb25UaWNrOiBwYXJhbXMub25UaWNrLFxyXG4gICAgICAgICAgb25Db21wbGV0ZTogcGFyYW1zLm9uQ29tcGxldGUsXHJcbiAgICAgICAgICBvbkFib3J0OiBwYXJhbXMub25BYm9ydCxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBwYXJhbXMub25UaWNrID0gKGFuaW1hdGVkU3R5bGUsIHQpID0+IHtcclxuICAgICAgICAgIG9yaWdpbmFsLm9uVGljayhhbmltYXRlZFN0eWxlLCB0KTtcclxuICAgICAgICAgIHRoaXMuc2V0U3RhdGVJZk1vdW50ZWQoeyBbdGhpcy5fQW5pbWF0ZU1peGluR2V0U3RhdGVLZXkobmFtZSldOiBhbmltYXRlZFN0eWxlIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHBhcmFtcy5vbkNvbXBsZXRlID0gKGFuaW1hdGVkU3R5bGUsIHQpID0+IHtcclxuICAgICAgICAgIG9yaWdpbmFsLm9uQ29tcGxldGUoYW5pbWF0ZWRTdHlsZSwgdCk7XHJcbiAgICAgICAgICBkZWxldGUgdGhpcy5fQW5pbWF0ZU1peGluSW50ZXJwb2xhdGlvblRpY2tlcnNbbmFtZV07XHJcbiAgICAgICAgICB0aGlzLnNldFN0YXRlSWZNb3VudGVkKHsgW3RoaXMuX0FuaW1hdGVNaXhpbkdldFN0YXRlS2V5KG5hbWUpXTogdm9pZCAwIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHBhcmFtcy5vbkFib3J0ID0gKCkgPT4ge1xyXG4gICAgICAgICAgb3JpZ2luYWwub25BYm9ydCgpO1xyXG4gICAgICAgICAgZGVsZXRlIHRoaXMuX0FuaW1hdGVNaXhpbkludGVycG9sYXRpb25UaWNrZXJzW25hbWVdO1xyXG4gICAgICAgICAgdGhpcy5zZXRTdGF0ZUlmTW91bnRlZCh7IFt0aGlzLl9BbmltYXRlTWl4aW5HZXRTdGF0ZUtleShuYW1lKV06IHZvaWQgMCB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBsZXQgaW50ZXJwb2xhdGlvblRpY2tlciA9IG5ldyBSLkFuaW1hdGUuSW50ZXJwb2xhdGlvblRpY2tlcihwYXJhbXMpO1xyXG4gICAgICAgIHRoaXMuX0FuaW1hdGVNaXhpbkludGVycG9sYXRpb25UaWNrZXJzW25hbWVdID0gaW50ZXJwb2xhdGlvblRpY2tlcjtcclxuICAgICAgICBpbnRlcnBvbGF0aW9uVGlja2VyLnN0YXJ0KCk7XHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG5cclxuICAgIGNyZWF0ZUludGVycG9sYXRvcihmcm9tLCB0bykge1xyXG4gICAgICByZXR1cm4gZDMuaW50ZXJwb2xhdGUoZnJvbSwgdG8pO1xyXG4gICAgfSxcclxuXHJcbiAgICBjcmVhdGVFYXNpbmcodHlwZSwgcGFyYW1zKSB7XHJcbiAgICAgIGlmKHBhcmFtcykge1xyXG4gICAgICAgIGxldCBhcmdzID0gXy5jbG9uZShwYXJhbXMpO1xyXG4gICAgICAgIGFyZ3MudW5zaGlmdCh0eXBlKTtcclxuICAgICAgICByZXR1cm4gZDMuZWFzZS5hcHBseShkMywgYXJncyk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGQzLmVhc2UodHlwZSk7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgSW50ZXJwb2xhdGlvblRpY2tlcixcclxuXHJcbiAgICBzaG91bGRFbmFibGVIQSgpIHtcclxuICAgICAgaWYoXy5pc0NsaWVudCgpKSB7XHJcbiAgICAgICAgbGV0IHVzZXJBZ2VudCA9IG5hdmlnYXRvci51c2VyQWdlbnQ7XHJcbiAgICAgICAgbGV0IGlzTW9iaWxlID0gL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxCbGFja0JlcnJ5fElFTW9iaWxlfE9wZXJhIE1pbmkvaS50ZXN0KHVzZXJBZ2VudCk7XHJcbiAgICAgICAgbGV0IGlzR2luZ2VyYnJlYWQgPSAvQW5kcm9pZCAyXFwuM1xcLlszLTddL2kudGVzdCh1c2VyQWdlbnQpO1xyXG4gICAgICAgIHJldHVybiB1c2VyQWdlbnQgJiYgaXNNb2JpbGUgJiYgIWlzR2luZ2VyYnJlYWQ7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIEFuaW1hdGU7XHJcbn07XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==