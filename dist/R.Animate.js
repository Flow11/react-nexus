"use strict";

var _classProps = function (child, staticProps, instanceProps) {
  if (staticProps) Object.defineProperties(child, staticProps);

  if (instanceProps) Object.defineProperties(child.prototype, instanceProps);
};

require("6to5/polyfill");
var Promise = require("bluebird");
module.exports = function (R) {
  var _ = R._;
  var should = R.should;
  var d3 = require("d3");
  var raf = require("raf");

  var InterpolationTicker = (function () {
    var InterpolationTicker = function InterpolationTicker() {
      var _this = this;

      _.dev(function () {
        return params.should.be.an.Object;
      });
      _.defaults(params, {
        easing: "cubic-in-out",
        onTick: _.noop,
        onComplete: _.noop,
        onAbort: _.noop });

      _.dev(function () {
        return params.from.should.be.an.Object && params.to.should.be.an.Object && params.duration.should.be.a.Number && (_.isPlainObject(params.easing) || _.isString(params.easing)).should.be.ok && params.onTick.should.be.a.Function && params.onComplete.should.be.a.Function && params.onAbort.should.be.a.Function;
      });

      this._from = params.from;
      this._to = params.to;

      Object.keys(this._from).forEach(function (attr) {
        return _.has(_this._to, attr) ? _this._to[attr] = _this._from[attr] : void 0;
      });
      Object.keys(this._to).forEach(function (attr) {
        return _.has(_this._from, attr) ? _this._from[attr] = _this._to[attr] : void 0;
      });

      if (_.isPlainObject(params.easing)) {
        _.dev(function () {
          return params.easing.type.should.be.a.String && params.easing.params.should.be.an.Object;
        });
        this._easing = R.Animate.createEasing(params.easing.type, params.easing.params);
      } else {
        this._easing = R.Animate.createEasing(params.easing);
      }
      this._duration = params.duration;
      this._onTick = params.onTick;
      this._onComplete = params.onComplete;
      this._onAbort = params.onAbort;
      this._interpolators = _.mapValues(this._from, function (fromVal, attr) {
        return R.Animate.createInterpolator(fromVal, _this._to[attr]);
      });
      this._tick = R.scope(this._tick, this);
    };

    _classProps(InterpolationTicker, null, {
      start: {
        writable: true,
        value: function () {
          var _this2 = this;

          _.dev(function () {
            return (_this2._begin === null).should.be.ok;
          });
          this._begin = Date.now();
          this._end = this._begin + this._duration;
          this._requestAnimationFrameHandle = raf(this._tick);
        }
      },
      _tick: {
        writable: true,
        value: function () {
          var _this3 = this;

          var now = Date.now();
          if (now > this._end) {
            this._onTick(this._to, t);
            this._onComplete();
          } else {
            (function () {
              var t = (now - _this3._begin) / (_this3._end - _this3._begin);
              _this3._onTick(_.mapValues(_this3._interpolators, function (interpolator) {
                return interpolator(_this3._easing(t));
              }, t));
              _this3._requestAnimationFrameHandle = raf(_this3._tick);
            })();
          }
        }
      },
      abort: {
        writable: true,
        value: function () {
          if (this._requestAnimationFrameHandle) {
            raf.cancel(this._requestAnimationFrameHandle);
            this._requestAnimationFrameHandle = null;
          }
        }
      }
    });

    return InterpolationTicker;
  })();

  _.extend(InterpolationTicker.prototype, /** @lends R.Animate.InterpolationTicker.prototype */{
    _from: null,
    _to: null,
    _easing: null,
    _duration: null,
    _onTick: null,
    _onComplete: null,
    _onAbort: null,
    _requestAnimationFrameHandle: null,
    _begin: null,
    _end: null,
    _interpolators: null });

  var Animate = {
    Mixin: {
      _AnimateMixinHasAnimateMixin: true,
      _AnimateMixinInterpolationTickers: null,

      componentWillMount: function () {
        this._AnimateMixinInterpolationTickers = {};
      },

      componentWillUnmount: function () {
        var _this4 = this;

        Object.keys(this._AnimateMixinInterpolationTickers).forEach(function (name) {
          return _this4._AnimateMixinInterpolationTickers[name].abort();
        });
        this._AnimateMixinInterpolationTickers = null;
      },

      isAnimating: function (name) {
        return this._AnimateMixinInterpolationTickers[name];
      },

      _AnimateMixinGetStateKey: function (name) {
        return "_AnimateMixinStyle-" + name;
      },

      getAnimatedStyle: function (name) {
        if (this.isAnimating(name)) {
          return this.state[this._AnimateMixinGetStateKey(name)];
        } else {
          _.dev(function () {
            return console.warn("R.Animate.Mixin.getAnimatedStyle(...): no such animation.");
          });
          return {};
        }
      },

      abortAnimation: function (name) {
        var _this5 = this;

        _.dev(function () {
          return _this5.isAnimating(name).should.be.ok;
        });
        if (this.isAnimating(name)) {
          this._AnimateMixinInterpolationTickers[name].abort();
        }
      },

      animate: function (name, params) {
        var _this6 = this;

        if (this.isAnimating(name)) {
          this.abortAnimation(name);
        }

        params = _.extend({}, params, {
          onTick: _.noop,
          onComplete: _.noop,
          onAbort: _.noop });

        var original = {
          onTick: params.onTick,
          onComplete: params.onComplete,
          onAbort: params.onAbort };

        params.onTick = function (animatedStyle, t) {
          original.onTick(animatedStyle, t);
          _this6.setStateIfMounted((function (_ref) {
            _ref[_this6._AnimateMixinGetStateKey(name)] = animatedStyle;
            return _ref;
          })({}));
        };

        params.onComplete = function (animatedStyle, t) {
          original.onComplete(animatedStyle, t);
          delete _this6._AnimateMixinInterpolationTickers[name];
          _this6.setStateIfMounted((function (_ref2) {
            _ref2[_this6._AnimateMixinGetStateKey(name)] = void 0;
            return _ref2;
          })({}));
        };

        params.onAbort = function () {
          original.onAbort();
          delete _this6._AnimateMixinInterpolationTickers[name];
          _this6.setStateIfMounted((function (_ref3) {
            _ref3[_this6._AnimateMixinGetStateKey(name)] = void 0;
            return _ref3;
          })({}));
        };

        var interpolationTicker = new R.Animate.InterpolationTicker(params);
        this._AnimateMixinInterpolationTickers[name] = interpolationTicker;
        interpolationTicker.start();
      } },

    createInterpolator: function (from, to) {
      return d3.interpolate(from, to);
    },

    createEasing: function (type, params) {
      if (params) {
        var args = _.clone(params);
        args.unshift(type);
        return d3.ease.apply(d3, args);
      } else {
        return d3.ease(type);
      }
    },

    InterpolationTicker: InterpolationTicker,

    shouldEnableHA: function () {
      if (_.isClient()) {
        var userAgent = navigator.userAgent;
        var isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);
        var isGingerbread = /Android 2\.3\.[3-7]/i.test(userAgent);
        return userAgent && isMobile && !isGingerbread;
      } else {
        return true;
      }
    } };

  return Animate;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImQ6L3dvcmtzcGFjZV9yZWZhY3Rvci9yZWFjdC1yYWlscy9zcmMvUi5BbmltYXRlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUEsT0FBTyxDQUFDLGVBQWUsQ0FBQyxDQUFDO0FBQ3pCLElBQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUNwQyxNQUFNLENBQUMsT0FBTyxHQUFHLFVBQVMsQ0FBQyxFQUFFO0FBQzNCLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDZCxNQUFNLE1BQU0sR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQ3hCLE1BQU0sRUFBRSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUN6QixNQUFNLEdBQUcsR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7O01BRXJCLG1CQUFtQjtRQUFuQixtQkFBbUIsR0FDWixTQURQLG1CQUFtQixHQUNUOzs7QUFDWixPQUFDLENBQUMsR0FBRyxDQUFDO2VBQU0sTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLE1BQU07T0FBQSxDQUFDLENBQUM7QUFDeEMsT0FBQyxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUU7QUFDakIsY0FBTSxFQUFFLGNBQWM7QUFDdEIsY0FBTSxFQUFFLENBQUMsQ0FBQyxJQUFJO0FBQ2Qsa0JBQVUsRUFBRSxDQUFDLENBQUMsSUFBSTtBQUNsQixlQUFPLEVBQUUsQ0FBQyxDQUFDLElBQUksRUFDaEIsQ0FBQyxDQUFDOztBQUVILE9BQUMsQ0FBQyxHQUFHLENBQUM7ZUFDSixNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLE1BQU0sSUFDL0IsTUFBTSxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxNQUFNLElBQzdCLE1BQU0sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxD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LEVBQUEsVUFBQyxJQUFJLEVBQUUsRUFBRSxFQUFFO0FBQzNCLGFBQU8sRUFBRSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLENBQUM7S0FDakM7O0FBRUQsZ0JBQVksRUFBQSxVQUFDLElBQUksRUFBRSxNQUFNLEVBQUU7QUFDekIsVUFBRyxNQUFNLEVBQUU7QUFDVCxZQUFJLElBQUksR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQzNCLFlBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDbkIsZUFBTyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDLENBQUM7T0FDaEMsTUFDSTtBQUNILGVBQU8sRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztPQUN0QjtLQUNGOztBQUVELHVCQUFtQixFQUFuQixtQkFBbUI7O0FBRW5CLGtCQUFjLEVBQUEsWUFBRztBQUNmLFVBQUcsQ0FBQyxDQUFDLFFBQVEsRUFBRSxFQUFFO0FBQ2YsWUFBSSxTQUFTLEdBQUcsU0FBUyxDQUFDLFNBQVMsQ0FBQztBQUNwQyxZQUFJLFFBQVEsR0FBRyxnRUFBZ0UsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDaEcsWUFBSSxhQUFhLEdBQUcsc0JBQXNCLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQzNELGVBQU8sU0FBUyxJQUFJLFFBQVEsSUFBSSxDQUFDLGFBQWEsQ0FBQztPQUNoRCxNQUNJO0FBQ0gsZUFBTyxJQUFJLENBQUM7T0FDYjtLQUNGLEVBQ0YsQ0FBQzs7QUFFRixTQUFPLE9BQU8sQ0FBQztDQUNoQixDQUFDIiwiZmlsZSI6IlIuQW5pbWF0ZS5qcyIsInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJzZ0bzUvcG9seWZpbGwnKTtcbmNvbnN0IFByb21pc2UgPSByZXF1aXJlKCdibHVlYmlyZCcpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihSKSB7XHJcbiAgY29uc3QgXyA9IFIuXztcclxuICBjb25zdCBzaG91bGQgPSBSLnNob3VsZDtcclxuICBjb25zdCBkMyA9IHJlcXVpcmUoJ2QzJyk7XHJcbiAgY29uc3QgcmFmID0gcmVxdWlyZSgncmFmJyk7XHJcblxyXG4gIGNsYXNzIEludGVycG9sYXRpb25UaWNrZXIge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgIF8uZGV2KCgpID0+IHBhcmFtcy5zaG91bGQuYmUuYW4uT2JqZWN0KTtcclxuICAgICAgXy5kZWZhdWx0cyhwYXJhbXMsIHtcclxuICAgICAgICBlYXNpbmc6ICdjdWJpYy1pbi1vdXQnLFxyXG4gICAgICAgIG9uVGljazogXy5ub29wLFxyXG4gICAgICAgIG9uQ29tcGxldGU6IF8ubm9vcCxcclxuICAgICAgICBvbkFib3J0OiBfLm5vb3AsXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgXy5kZXYoKCkgPT5cclxuICAgICAgICBwYXJhbXMuZnJvbS5zaG91bGQuYmUuYW4uT2JqZWN0ICYmXHJcbiAgICAgICAgcGFyYW1zLnRvLnNob3VsZC5iZS5hbi5PYmplY3QgJiZcclxuICAgICAgICBwYXJhbXMuZHVyYXRpb24uc2hvdWxkLmJlLmEuTnVtYmVyICYmXHJcbiAgICAgICAgKF8uaXNQbGFpbk9iamVjdChwYXJhbXMuZWFzaW5nKSB8fCBfLmlzU3RyaW5nKHBhcmFtcy5lYXNpbmcpKS5zaG91bGQuYmUub2sgJiZcclxuICAgICAgICBwYXJhbXMub25UaWNrLnNob3VsZC5iZS5hLkZ1bmN0aW9uICYmXHJcbiAgICAgICAgcGFyYW1zLm9uQ29tcGxldGUuc2hvdWxkLmJlLmEuRnVuY3Rpb24gJiZcclxuICAgICAgICBwYXJhbXMub25BYm9ydC5zaG91bGQuYmUuYS5GdW5jdGlvblxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICB0aGlzLl9mcm9tID0gcGFyYW1zLmZyb207XHJcbiAgICAgIHRoaXMuX3RvID0gcGFyYW1zLnRvO1xyXG5cclxuICAgICAgT2JqZWN0LmtleXModGhpcy5fZnJvbSlcclxuICAgICAgLmZvckVhY2goKGF0dHIpID0+IF8uaGFzKHRoaXMuX3RvLCBhdHRyKSA/IHRoaXMuX3RvW2F0dHJdID0gdGhpcy5fZnJvbVthdHRyXSA6IHZvaWQgMCk7XHJcbiAgICAgIE9iamVjdC5rZXlzKHRoaXMuX3RvKVxyXG4gICAgICAuZm9yRWFjaCgoYXR0cikgPT4gXy5oYXModGhpcy5fZnJvbSwgYXR0cikgPyB0aGlzLl9mcm9tW2F0dHJdID0gdGhpcy5fdG9bYXR0cl0gOiB2b2lkIDApO1xyXG5cclxuICAgICAgaWYoXy5pc1BsYWluT2JqZWN0KHBhcmFtcy5lYXNpbmcpKSB7XHJcbiAgICAgICAgXy5kZXYoKCkgPT4gcGFyYW1zLmVhc2luZy50eXBlLnNob3VsZC5iZS5hLlN0cmluZyAmJlxyXG4gICAgICAgICAgcGFyYW1zLmVhc2luZy5wYXJhbXMuc2hvdWxkLmJlLmFuLk9iamVjdFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgdGhpcy5fZWFzaW5nID0gUi5BbmltYXRlLmNyZWF0ZUVhc2luZyhwYXJhbXMuZWFzaW5nLnR5cGUsIHBhcmFtcy5lYXNpbmcucGFyYW1zKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICB0aGlzLl9lYXNpbmcgPSBSLkFuaW1hdGUuY3JlYXRlRWFzaW5nKHBhcmFtcy5lYXNpbmcpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuX2R1cmF0aW9uID0gcGFyYW1zLmR1cmF0aW9uO1xyXG4gICAgICB0aGlzLl9vblRpY2sgPSBwYXJhbXMub25UaWNrO1xyXG4gICAgICB0aGlzLl9vbkNvbXBsZXRlID0gcGFyYW1zLm9uQ29tcGxldGU7XHJcbiAgICAgIHRoaXMuX29uQWJvcnQgPSBwYXJhbXMub25BYm9ydDtcclxuICAgICAgdGhpcy5faW50ZXJwb2xhdG9ycyA9IF8ubWFwVmFsdWVzKHRoaXMuX2Zyb20sIChmcm9tVmFsLCBhdHRyKSA9PiBSLkFuaW1hdGUuY3JlYXRlSW50ZXJwb2xhdG9yKGZyb21WYWwsIHRoaXMuX3RvW2F0dHJdKSk7XHJcbiAgICAgIHRoaXMuX3RpY2sgPSBSLnNjb3BlKHRoaXMuX3RpY2ssIHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXJ0KCkge1xyXG4gICAgICBfLmRldigoKSA9PiAodGhpcy5fYmVnaW4gPT09IG51bGwpLnNob3VsZC5iZS5vayk7XHJcbiAgICAgIHRoaXMuX2JlZ2luID0gRGF0ZS5ub3coKTtcclxuICAgICAgdGhpcy5fZW5kID0gdGhpcy5fYmVnaW4gKyB0aGlzLl9kdXJhdGlvbjtcclxuICAgICAgdGhpcy5fcmVxdWVzdEFuaW1hdGlvbkZyYW1lSGFuZGxlID0gcmFmKHRoaXMuX3RpY2spO1xyXG4gICAgfVxyXG5cclxuICAgIF90aWNrKCkge1xyXG4gICAgICBsZXQgbm93ID0gRGF0ZS5ub3coKTtcclxuICAgICAgaWYobm93ID4gdGhpcy5fZW5kKSB7XHJcbiAgICAgICAgdGhpcy5fb25UaWNrKHRoaXMuX3RvLCB0KTtcclxuICAgICAgICB0aGlzLl9vbkNvbXBsZXRlKCk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgbGV0IHQgPSAobm93IC0gdGhpcy5fYmVnaW4pLyh0aGlzLl9lbmQgLSB0aGlzLl9iZWdpbik7XHJcbiAgICAgICAgdGhpcy5fb25UaWNrKF8ubWFwVmFsdWVzKHRoaXMuX2ludGVycG9sYXRvcnMsIChpbnRlcnBvbGF0b3IpID0+IGludGVycG9sYXRvcih0aGlzLl9lYXNpbmcodCkpLCB0KSk7XHJcbiAgICAgICAgdGhpcy5fcmVxdWVzdEFuaW1hdGlvbkZyYW1lSGFuZGxlID0gcmFmKHRoaXMuX3RpY2spO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYWJvcnQoKSB7XHJcbiAgICAgIGlmKHRoaXMuX3JlcXVlc3RBbmltYXRpb25GcmFtZUhhbmRsZSkge1xyXG4gICAgICAgIHJhZi5jYW5jZWwodGhpcy5fcmVxdWVzdEFuaW1hdGlvbkZyYW1lSGFuZGxlKTtcclxuICAgICAgICB0aGlzLl9yZXF1ZXN0QW5pbWF0aW9uRnJhbWVIYW5kbGUgPSBudWxsO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuXHJcbiAgXy5leHRlbmQoSW50ZXJwb2xhdGlvblRpY2tlci5wcm90b3R5cGUsIC8qKiBAbGVuZHMgUi5BbmltYXRlLkludGVycG9sYXRpb25UaWNrZXIucHJvdG90eXBlICovIHtcclxuICAgIF9mcm9tOiBudWxsLFxyXG4gICAgX3RvOiBudWxsLFxyXG4gICAgX2Vhc2luZzogbnVsbCxcclxuICAgIF9kdXJhdGlvbjogbnVsbCxcclxuICAgIF9vblRpY2s6IG51bGwsXHJcbiAgICBfb25Db21wbGV0ZTogbnVsbCxcclxuICAgIF9vbkFib3J0OiBudWxsLFxyXG4gICAgX3JlcXVlc3RBbmltYXRpb25GcmFtZUhhbmRsZTogbnVsbCxcclxuICAgIF9iZWdpbjogbnVsbCxcclxuICAgIF9lbmQ6IG51bGwsXHJcbiAgICBfaW50ZXJwb2xhdG9yczogbnVsbCxcclxuICB9KTtcclxuXHJcbiAgY29uc3QgQW5pbWF0ZSA9IHtcclxuICAgIE1peGluOiB7XHJcbiAgICAgIF9BbmltYXRlTWl4aW5IYXNBbmltYXRlTWl4aW46IHRydWUsXHJcbiAgICAgIF9BbmltYXRlTWl4aW5JbnRlcnBvbGF0aW9uVGlja2VyczogbnVsbCxcclxuXHJcbiAgICAgIGNvbXBvbmVudFdpbGxNb3VudCgpIHtcclxuICAgICAgICB0aGlzLl9BbmltYXRlTWl4aW5JbnRlcnBvbGF0aW9uVGlja2VycyA9IHt9O1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XHJcbiAgICAgICAgT2JqZWN0LmtleXModGhpcy5fQW5pbWF0ZU1peGluSW50ZXJwb2xhdGlvblRpY2tlcnMpXHJcbiAgICAgICAgLmZvckVhY2goKG5hbWUpID0+IHRoaXMuX0FuaW1hdGVNaXhpbkludGVycG9sYXRpb25UaWNrZXJzW25hbWVdLmFib3J0KCkpO1xyXG4gICAgICAgIHRoaXMuX0FuaW1hdGVNaXhpbkludGVycG9sYXRpb25UaWNrZXJzID0gbnVsbDtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGlzQW5pbWF0aW5nKG5hbWUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fQW5pbWF0ZU1peGluSW50ZXJwb2xhdGlvblRpY2tlcnNbbmFtZV07XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBfQW5pbWF0ZU1peGluR2V0U3RhdGVLZXkobmFtZSkge1xyXG4gICAgICAgIHJldHVybiAnX0FuaW1hdGVNaXhpblN0eWxlLScgKyBuYW1lO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgZ2V0QW5pbWF0ZWRTdHlsZShuYW1lKSB7XHJcbiAgICAgICAgaWYodGhpcy5pc0FuaW1hdGluZyhuYW1lKSkge1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuc3RhdGVbdGhpcy5fQW5pbWF0ZU1peGluR2V0U3RhdGVLZXkobmFtZSldO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIF8uZGV2KCgpID0+IGNvbnNvbGUud2FybignUi5BbmltYXRlLk1peGluLmdldEFuaW1hdGVkU3R5bGUoLi4uKTogbm8gc3VjaCBhbmltYXRpb24uJykpO1xyXG4gICAgICAgICAgcmV0dXJuIHt9O1xyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuXHJcbiAgICAgIGFib3J0QW5pbWF0aW9uKG5hbWUpIHtcclxuICAgICAgICBfLmRldigoKSA9PiB0aGlzLmlzQW5pbWF0aW5nKG5hbWUpLnNob3VsZC5iZS5vayk7XHJcbiAgICAgICAgaWYodGhpcy5pc0FuaW1hdGluZyhuYW1lKSkge1xyXG4gICAgICAgICAgdGhpcy5fQW5pbWF0ZU1peGluSW50ZXJwb2xhdGlvblRpY2tlcnNbbmFtZV0uYWJvcnQoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBhbmltYXRlKG5hbWUsIHBhcmFtcykge1xyXG4gICAgICAgIGlmKHRoaXMuaXNBbmltYXRpbmcobmFtZSkpIHtcclxuICAgICAgICAgIHRoaXMuYWJvcnRBbmltYXRpb24obmFtZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwYXJhbXMgPSBfLmV4dGVuZCh7fSwgcGFyYW1zLCB7XHJcbiAgICAgICAgICBvblRpY2s6IF8ubm9vcCxcclxuICAgICAgICAgIG9uQ29tcGxldGU6IF8ubm9vcCxcclxuICAgICAgICAgIG9uQWJvcnQ6IF8ubm9vcCxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IG9yaWdpbmFsID0ge1xyXG4gICAgICAgICAgb25UaWNrOiBwYXJhbXMub25UaWNrLFxyXG4gICAgICAgICAgb25Db21wbGV0ZTogcGFyYW1zLm9uQ29tcGxldGUsXHJcbiAgICAgICAgICBvbkFib3J0OiBwYXJhbXMub25BYm9ydCxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBwYXJhbXMub25UaWNrID0gKGFuaW1hdGVkU3R5bGUsIHQpID0+IHtcclxuICAgICAgICAgIG9yaWdpbmFsLm9uVGljayhhbmltYXRlZFN0eWxlLCB0KTtcclxuICAgICAgICAgIHRoaXMuc2V0U3RhdGVJZk1vdW50ZWQoeyBbdGhpcy5fQW5pbWF0ZU1peGluR2V0U3RhdGVLZXkobmFtZSldOiBhbmltYXRlZFN0eWxlIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHBhcmFtcy5vbkNvbXBsZXRlID0gKGFuaW1hdGVkU3R5bGUsIHQpID0+IHtcclxuICAgICAgICAgIG9yaWdpbmFsLm9uQ29tcGxldGUoYW5pbWF0ZWRTdHlsZSwgdCk7XHJcbiAgICAgICAgICBkZWxldGUgdGhpcy5fQW5pbWF0ZU1peGluSW50ZXJwb2xhdGlvblRpY2tlcnNbbmFtZV07XHJcbiAgICAgICAgICB0aGlzLnNldFN0YXRlSWZNb3VudGVkKHsgW3RoaXMuX0FuaW1hdGVNaXhpbkdldFN0YXRlS2V5KG5hbWUpXTogdm9pZCAwIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHBhcmFtcy5vbkFib3J0ID0gKCkgPT4ge1xyXG4gICAgICAgICAgb3JpZ2luYWwub25BYm9ydCgpO1xyXG4gICAgICAgICAgZGVsZXRlIHRoaXMuX0FuaW1hdGVNaXhpbkludGVycG9sYXRpb25UaWNrZXJzW25hbWVdO1xyXG4gICAgICAgICAgdGhpcy5zZXRTdGF0ZUlmTW91bnRlZCh7IFt0aGlzLl9BbmltYXRlTWl4aW5HZXRTdGF0ZUtleShuYW1lKV06IHZvaWQgMCB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBsZXQgaW50ZXJwb2xhdGlvblRpY2tlciA9IG5ldyBSLkFuaW1hdGUuSW50ZXJwb2xhdGlvblRpY2tlcihwYXJhbXMpO1xyXG4gICAgICAgIHRoaXMuX0FuaW1hdGVNaXhpbkludGVycG9sYXRpb25UaWNrZXJzW25hbWVdID0gaW50ZXJwb2xhdGlvblRpY2tlcjtcclxuICAgICAgICBpbnRlcnBvbGF0aW9uVGlja2VyLnN0YXJ0KCk7XHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG5cclxuICAgIGNyZWF0ZUludGVycG9sYXRvcihmcm9tLCB0bykge1xyXG4gICAgICByZXR1cm4gZDMuaW50ZXJwb2xhdGUoZnJvbSwgdG8pO1xyXG4gICAgfSxcclxuXHJcbiAgICBjcmVhdGVFYXNpbmcodHlwZSwgcGFyYW1zKSB7XHJcbiAgICAgIGlmKHBhcmFtcykge1xyXG4gICAgICAgIGxldCBhcmdzID0gXy5jbG9uZShwYXJhbXMpO1xyXG4gICAgICAgIGFyZ3MudW5zaGlmdCh0eXBlKTtcclxuICAgICAgICByZXR1cm4gZDMuZWFzZS5hcHBseShkMywgYXJncyk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGQzLmVhc2UodHlwZSk7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgSW50ZXJwb2xhdGlvblRpY2tlcixcclxuXHJcbiAgICBzaG91bGRFbmFibGVIQSgpIHtcclxuICAgICAgaWYoXy5pc0NsaWVudCgpKSB7XHJcbiAgICAgICAgbGV0IHVzZXJBZ2VudCA9IG5hdmlnYXRvci51c2VyQWdlbnQ7XHJcbiAgICAgICAgbGV0IGlzTW9iaWxlID0gL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxCbGFja0JlcnJ5fElFTW9iaWxlfE9wZXJhIE1pbmkvaS50ZXN0KHVzZXJBZ2VudCk7XHJcbiAgICAgICAgbGV0IGlzR2luZ2VyYnJlYWQgPSAvQW5kcm9pZCAyXFwuM1xcLlszLTddL2kudGVzdCh1c2VyQWdlbnQpO1xyXG4gICAgICAgIHJldHVybiB1c2VyQWdlbnQgJiYgaXNNb2JpbGUgJiYgIWlzR2luZ2VyYnJlYWQ7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIEFuaW1hdGU7XHJcbn07XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==